<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EditDistance.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">com.irurueta:irurueta-commons</a> &gt; <a href="index.source.html" class="el_package">com.irurueta.commons</a> &gt; <span class="el_source">EditDistance.java</span></div><h1>EditDistance.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2016 Alberto Irurueta Carro (alberto@irurueta.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.irurueta.commons;

/**
 * Utility class to compute Levenshtein distance (number of
 * substitutions/modifications) between two arrays or strings.
 * Levenshtein distance is an approximate comparison measure that has into
 * account the number of modifications, added or removed elements required to
 * make two collections equal. Thus, this distance measure is appropriate to
 * compare similar but not exactly equal Strings (to take into account
 * typographic errors, etc).
 */
public class EditDistance {

    /**
     * Constructor.
     */
<span class="fc" id="L32">    protected EditDistance() {</span>
<span class="fc" id="L33">    }</span>

    /**
     * Computes Levenshtein distance between two Strings.
     *
     * @param x 1st String.
     * @param y 2nd String.
     * @return Levenshtein distance.
     */
    public static int stringDistance(final String x, final String y) {
<span class="fc" id="L43">        return distance(new StringArrayWrapper(x), new StringArrayWrapper(y));</span>
    }

    /**
     * Computes Levenshtein distance between two arrays of objects of type
     * T.
     * NOTE: this method cannot be used with arrays of primitive types,
     * instead an array of wrappers of primitive objects must be used or
     * this class must be extended to add implementations of ArrayWrappers
     * for all primitive types that must be supported.
     *
     * @param x   1st array of objects of type T.
     * @param y   2nd array of objects of type T.
     * @param &lt;T&gt; type of arrays.
     * @return Levenshtein distance.
     */
    public static &lt;T&gt; int distance(final T[] x, final T[] y) {
<span class="fc" id="L60">        return distance(new GenericArrayWrapper&lt;&gt;(x),</span>
                new GenericArrayWrapper&lt;&gt;(y));
    }

    /**
     * Computes Levenshtein distance between two arrays of type T. To compute
     * this distance an ArrayWrapper is used to make a more efficient access to
     * primitive datatypes or strings.
     *
     * @param x   1st array of objects of type T.
     * @param y   2nd array of objects of type T.
     * @param &lt;T&gt; type of arrays.
     * @return Levenshtein distance.
     */
    private static &lt;T&gt; int distance(final ArrayWrapper&lt;T&gt; x, final ArrayWrapper&lt;T&gt; y) {

        // validate parameters
<span class="pc bpc" id="L77" title="2 of 4 branches missed.">        if (x == null || y == null) {</span>
<span class="nc" id="L78">            throw new IllegalArgumentException();</span>
        }

        // Obtains length of both parameters. If one of them is 0, we return the
        // length of the other, since that number of insertions will be required
<span class="fc" id="L83">        final int n = x.length();</span>
<span class="fc" id="L84">        final int m = y.length();</span>
<span class="pc bpc" id="L85" title="1 of 2 branches missed.">        if (n == 0) {</span>
<span class="nc" id="L86">            return m;</span>
        }
<span class="pc bpc" id="L88" title="1 of 2 branches missed.">        if (m == 0) {</span>
<span class="nc" id="L89">            return n;</span>
        }

        // Instead of keeping a whole matrix (which would require an O(n*m)
        // space, we just keep current and next rows, both of which have a length
        // of m+1, and hence only O(n) space is required.
        // Initialize current row.
<span class="fc" id="L96">        int curRow = 0;</span>
<span class="fc" id="L97">        int nextRow = 1;</span>
<span class="fc" id="L98">        final int[][] rows = new int[][]{new int[m + 1], new int[m + 1]};</span>
<span class="fc bfc" id="L99" title="All 2 branches covered.">        for (int j = 0; j &lt;= m; ++j) {</span>
<span class="fc" id="L100">            rows[curRow][j] = j;</span>
        }

        // for each virtual row (since we only keep two)
<span class="fc bfc" id="L104" title="All 2 branches covered.">        for (int i = 1; i &lt;= n; ++i) {</span>
            // fill values of row
<span class="fc" id="L106">            rows[nextRow][0] = i;</span>
<span class="fc bfc" id="L107" title="All 2 branches covered.">            for (int j = 1; j &lt;= m; ++j) {</span>
<span class="fc" id="L108">                final int dist1 = rows[curRow][j] + 1;</span>
<span class="fc" id="L109">                final int dist2 = rows[nextRow][j - 1] + 1;</span>
<span class="fc" id="L110">                final int dist3 = rows[curRow][j - 1] +</span>
<span class="fc bfc" id="L111" title="All 2 branches covered.">                        (x.equals(y, i - 1, j - 1) ? 0 : 1);</span>

<span class="fc" id="L113">                rows[nextRow][j] = Math.min(dist1, Math.min(dist2, dist3));</span>
            }

            // exchanges current and next rows
<span class="fc bfc" id="L117" title="All 2 branches covered.">            if (curRow == 0) {</span>
<span class="fc" id="L118">                curRow = 1;</span>
<span class="fc" id="L119">                nextRow = 0;</span>
            } else {
<span class="fc" id="L121">                curRow = 0;</span>
<span class="fc" id="L122">                nextRow = 1;</span>
            }
        }

        // returns computed distance
<span class="fc" id="L127">        return rows[curRow][m];</span>
    }

    /**
     * Interface used as a wrapper for arrays of type T used to generalized
     * efficient access to elements of an array of a generic data type T.
     * String implementations are provided as well as implementations for
     * generic objects of type T. If primitive data types arrays must be
     * supported, then the necessary implementation will need to be added
     * similarly to existent ones.
     *
     * @param &lt;T&gt; generic data type.
     */
    protected interface ArrayWrapper&lt;T&gt; {
        /**
         * Obtains length of array.
         *
         * @return length of array.
         */
        int length();

        /**
         * Compares this array in position x, with the other object at position
         * y.
         *
         * @param other the other array wrapper.
         * @param posX  position within this array that must be compared.
         * @param posY  position within the other array that must be compared.
         * @return true if elements in provided positions are equal, false
         * otherwise.
         */
        boolean equals(final ArrayWrapper&lt;T&gt; other, final int posX, final int posY);
    }

    /**
     * Specific implementation of ArrayWrapper for Strings.
     * Allows efficient comparison of String elements in a generic way.
     *
     * @author Alberto Irurueta Carro
     */
    protected static class StringArrayWrapper implements ArrayWrapper&lt;String&gt; {
        /**
         * String to be compared.
         */
        private final String mObject;

        /**
         * Constructor.
         *
         * @param object string to be compared.
         */
<span class="fc" id="L178">        public StringArrayWrapper(final String object) {</span>
<span class="fc" id="L179">            mObject = object;</span>
<span class="fc" id="L180">        }</span>

        /**
         * Length of the string to be compared.
         */
        @Override
        public int length() {
<span class="fc" id="L187">            return mObject.length();</span>
        }

        /**
         * Compares the string contained in this instance at position x with
         * the string contained in the other array wrapper at position y.
         *
         * @param other the other String array wrapper.
         * @param posX  position in this array to be compared.
         * @param posY  position in the other array to be compared.
         * @return true if elements in provided positions are considered to
         * be equal, false otherwise.
         */
        @Override
        public boolean equals(final ArrayWrapper&lt;String&gt; other, final int posX,
                              final int posY) {

<span class="pc bpc" id="L204" title="1 of 2 branches missed.">            if (!(other instanceof StringArrayWrapper)) {</span>
<span class="nc" id="L205">                return false;</span>
            }

<span class="fc" id="L208">            final String otherObject = ((StringArrayWrapper) other).mObject;</span>
<span class="fc bfc" id="L209" title="All 2 branches covered.">            return mObject.charAt(posX) == otherObject.charAt(posY);</span>
        }
    }

    /**
     * Implementation of ArrayWrapper for generic objects of type T.
     * Allows the efficient and generic comparison of objects of type T, as long
     * as T is not a primitive data type.
     *
     * @param &lt;T&gt; generic data type.
     */
    protected static class GenericArrayWrapper&lt;T&gt; implements ArrayWrapper&lt;T[]&gt; {
        /**
         * Generic array of type T to be compared.
         */
        private final T[] mObject;

        /**
         * Constructor.
         *
         * @param object generic array of type T to be compared.
         */
<span class="fc" id="L231">        public GenericArrayWrapper(final T[] object) {</span>
<span class="fc" id="L232">            mObject = object;</span>
<span class="fc" id="L233">        }</span>

        /**
         * Length of array to be compared.
         */
        @Override
        public int length() {
<span class="fc" id="L240">            return mObject.length;</span>
        }

        /**
         * Compares the array contained in this instance at position X with the
         * array contained in the other array wrapper at position Y.
         *
         * @param other the other generic array wrapper.
         * @param posX  position in this array to be compared.
         * @param posY  position in the other array to be compared.
         * @return true if elements in both arrays at provided positions are
         * considered to be equal, false otherwise.
         */
        @Override
        public boolean equals(final ArrayWrapper&lt;T[]&gt; other, final int posX, final int posY) {
<span class="pc bpc" id="L255" title="1 of 2 branches missed.">            if (!(other instanceof GenericArrayWrapper)) {</span>
<span class="nc" id="L256">                return false;</span>
            }

<span class="fc" id="L259">            final T[] otherObject = ((GenericArrayWrapper&lt;T&gt;) other).mObject;</span>
<span class="fc" id="L260">            return mObject[posX].equals(otherObject[posY]);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>